<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GoodData Calculator</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide-react@0.263.1/dist/umd/lucide-react.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Calculator, Building, Users, Database, FileText } = lucideReact;

        // Direct Supabase integration using multiple bypass techniques
        class SupabaseStorage {
            constructor() {
                this.supabaseUrl = 'https://ysaxvpcwlmxdbietmjrl.supabase.co';
                this.supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlzYXh2cGN3bG14ZGJpZXRtanJsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQxNzYwOTMsImV4cCI6MjA0OTc1MjA5M30.D6CXJo9KBLHfEovgI-5Z4qFQJSPmC_jpc3MiOy3zd';
                
                // Local backup
                this.quotes = new Map();
                this.loadLocalQuotes();
            }

            loadLocalQuotes() {
                try {
                    const saved = localStorage.getItem('gooddata_quotes');
                    if (saved) {
                        const parsed = JSON.parse(saved);
                        Object.entries(parsed).forEach(([code, data]) => {
                            this.quotes.set(code, data);
                        });
                    }
                } catch (e) {
                    console.log('localStorage not available');
                }
            }

            // Try simple fetch first
            async trySimpleFetch(method, url, body = null) {
                try {
                    console.log(`🔄 Trying simple ${method} to Supabase...`);
                    
                    const options = {
                        method: method,
                        headers: {
                            'Content-Type': 'application/json',
                            'apikey': this.supabaseKey,
                            'Authorization': `Bearer ${this.supabaseKey}`
                        }
                    };
                    
                    if (body) {
                        options.body = JSON.stringify(body);
                    }
                    
                    const response = await fetch(url, options);
                    
                    if (response.ok) {
                        console.log('✅ Simple fetch worked!');
                        return await response.json();
                    } else {
                        console.log('❌ Simple fetch failed:', response.status);
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    console.log('❌ Simple fetch error:', error.message);
                    throw error;
                }
            }

            async save(code, data) {
                console.log('📝 Starting save process...');
                
                // Save locally first
                const quoteData = {
                    data: data,
                    timestamp: new Date().toISOString(),
                    code: code
                };
                
                this.quotes.set(code, quoteData);
                
                try {
                    const allQuotes = {};
                    this.quotes.forEach((value, key) => {
                        allQuotes[key] = value;
                    });
                    localStorage.setItem('gooddata_quotes', JSON.stringify(allQuotes));
                    console.log('✅ Saved locally');
                } catch (e) {
                    console.log('❌ Local save failed');
                }

                // Try Supabase
                let cloudSaved = false;
                let error = null;
                
                try {
                    await this.trySimpleFetch('POST', `${this.supabaseUrl}/rest/v1/Quotes`, {
                        code: code,
                        data: data,
                        updated_at: new Date().toISOString()
                    });
                    cloudSaved = true;
                } catch (e) {
                    error = e.message;
                }
                
                return {
                    success: true,
                    code: code,
                    cloudSaved: cloudSaved,
                    error: error
                };
            }

            async load(code) {
                console.log('📖 Starting load process...');
                
                // Try Supabase first
                try {
                    const data = await this.trySimpleFetch('GET', `${this.supabaseUrl}/rest/v1/Quotes?code=eq.${code}&select=*`);
                    
                    if (data && data.length > 0) {
                        console.log('✅ Loaded from Supabase');
                        const quoteData = {
                            data: data[0].data,
                            timestamp: new Date().toISOString(),
                            code: code
                        };
                        this.quotes.set(code, quoteData);
                        
                        return {
                            success: true,
                            data: data[0].data,
                            code: code,
                            source: 'supabase'
                        };
                    }
                } catch (e) {
                    console.log('Supabase load failed, checking local...');
                }

                // Fall back to local
                if (this.quotes.has(code)) {
                    console.log('✅ Loaded from local storage');
                    const quoteData = this.quotes.get(code);
                    return {
                        success: true,
                        data: quoteData.data,
                        code: code,
                        source: 'local'
                    };
                }

                return { success: false, error: 'Quote not found' };
            }

            getAllCodes() {
                return Array.from(this.quotes.keys());
            }
        }

        const cloudStorage = new SupabaseStorage();

        function GoodDataCalculator() {
            const [activeTab, setActiveTab] = useState('qualification');
            const [templateCode, setTemplateCode] = useState('');
            const [showSaveDialog, setShowSaveDialog] = useState(false);
            const [generatedCode, setGeneratedCode] = useState('');
            const [loading, setLoading] = useState(false);
            const [message, setMessage] = useState('');
            const [cloudStatus, setCloudStatus] = useState('');
            
            const [formData, setFormData] = useState({
                prospectName: '',
                clientWebsite: '',
                annualRevenue: '',
                budget: '',
                objectives: '',
                totalWorkspaces: '',
                biWorkspaces: '',
                aiWorkspaces: '',
                llmProvider: '',
                package: '',
                professionalServices: '',
                additionalEnvironments: false,
                samlOidc: false,
                dataCenterRegions: false,
                usageAnalytics: false,
                auditLog: false,
                hipaaCompliance: false,
                aeComments: '',
                financeComments: '',
                specialConsiderations: {
                    securityConcerns: '',
                    architectureConcerns: '',
                    upCharges: '',
                    dedicatedCluster: ''
                },
                usagePlan: {
                    usageType: '',
                    monetization: '',
                    growthOpportunity: ''
                },
                considerations: {
                    budgetConsiderations: '',
                    timelineConsiderations: '',
                    riskFactors: '',
                    implementationComplexity: ''
                }
            });

            const [pricing, setPricing] = useState({
                platformFee: 36000,
                biWorkspacePrice: 25,
                aiWorkspacePrice: 10,
                advisory: 10000,
                analytics: 37500,
                endToEnd: 100000,
                additionalEnvironments: 12000,
                samlOidc: 3000,
                dataCenterRegions: 5000,
                usageAnalytics: 2500,
                auditLog: 3000,
                hipaaCompliance: 8000,
                llmPackages: {
                    'Customer': { 'Small': 100, 'Medium': 430, 'Large': 750 },
                    'GoodData': { 'Small': 200, 'Medium': 860, 'Large': 1500 }
                }
            });

            const generateTemplateCode = () => {
                let companyPart = 'PROSPECT';
                if (formData.prospectName) {
                    companyPart = formData.prospectName
                        .replace(/[^a-zA-Z0-9]/g, '')
                        .toUpperCase()
                        .substring(0, 8);
                }
                
                const now = new Date();
                const monthNames = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 
                                    'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
                const month = monthNames[now.getMonth()];
                const day = now.getDate().toString().padStart(2, '0');
                
                return `${companyPart}-${month}${day}`;
            };

            const saveTemplate = async () => {
                if (!formData.prospectName) {
                    setMessage('❌ Please enter a prospect name before saving');
                    setTimeout(() => setMessage(''), 3000);
                    return;
                }

                const code = generateTemplateCode();
                setLoading(true);
                setMessage('🔄 Saving quote to Supabase...');
                setCloudStatus('Attempting direct connection...');
                
                try {
                    const result = await cloudStorage.save(code, formData);
                    if (result.success) {
                        setGeneratedCode(code);
                        setShowSaveDialog(true);
                        
                        if (result.cloudSaved) {
                            setMessage(`✅ Quote saved to Supabase: ${code} - Share anywhere!`);
                            setCloudStatus('✅ Successfully saved to cloud database');
                        } else {
                            setMessage(`⚠️ Quote saved locally: ${code} - Cloud sync failed`);
                            setCloudStatus(`❌ Cloud error: ${result.error || 'Connection failed'}`);
                        }
                        
                        setTimeout(() => {
                            setMessage('');
                            setCloudStatus('');
                        }, 4000);
                    }
                } catch (error) {
                    setMessage('❌ Error saving quote');
                    setCloudStatus('❌ Save failed');
                    setTimeout(() => {
                        setMessage('');
                        setCloudStatus('');
                    }, 3000);
                }
                
                setLoading(false);
            };

            const loadTemplate = async () => {
                if (!templateCode.trim()) {
                    setMessage('❌ Please enter a quote code');
                    setTimeout(() => setMessage(''), 3000);
                    return;
                }

                setLoading(true);
                setMessage('🔄 Loading quote from Supabase...');
                setCloudStatus('Checking cloud database...');
                
                try {
                    const result = await cloudStorage.load(templateCode.toUpperCase());
                    if (result.success) {
                        setFormData(result.data);
                        const sourceText = result.source === 'supabase' ? 'from Supabase cloud ☁️' : 'from local storage 💾';
                        setMessage(`✅ Quote "${result.code}" loaded ${sourceText}!`);
                        setCloudStatus(result.source === 'supabase' ? '☁️ Loaded from cloud database' : '💾 Loaded from local backup');
                        setTemplateCode('');
                        setTimeout(() => {
                            setMessage('');
                            setCloudStatus('');
                        }, 4000);
                    } else {
                        setMessage(`❌ Quote "${templateCode.toUpperCase()}" not found`);
                        setCloudStatus('❌ Not found in cloud or local storage');
                        setTimeout(() => {
                            setMessage('');
                            setCloudStatus('');
                        }, 3000);
                    }
                } catch (error) {
                    setMessage('❌ Error loading quote');
                    setCloudStatus('❌ Load failed');
                    setTimeout(() => {
                        setMessage('');
                        setCloudStatus('');
                    }, 3000);
                }
                
                setLoading(false);
            };

            const handleInputChange = (field, value) => {
                setFormData(prev => {
                    const newData = { ...prev, [field]: value };
                    
                    // Mirror Total Workspaces to BI Workspaces
                    if (field === 'totalWorkspaces') {
                        newData.biWorkspaces = value;
                    }
                    
                    return newData;
                });
            };

            const calculateTotal = () => {
                const bi = parseInt(formData.biWorkspaces) || 0;
                const ai = parseInt(formData.aiWorkspaces) || 0;
                
                let total = pricing.platformFee + (bi * pricing.biWorkspacePrice * 12) + (ai * pricing.aiWorkspacePrice * 12);
                
                // Add LLM Package costs
                if (formData.llmProvider && formData.package) {
                    const monthlyCost = pricing.llmPackages[formData.llmProvider]?.[formData.package] || 0;
                    total += monthlyCost * 12; // Convert to annual
                }
                
                if (formData.professionalServices === 'Advisory') total += pricing.advisory;
                if (formData.professionalServices === 'Analytics') total += pricing.analytics;
                if (formData.professionalServices === 'End-to-end') total += pricing.endToEnd;
                if (formData.additionalEnvironments) total += pricing.additionalEnvironments;
                if (formData.samlOidc) total += pricing.samlOidc;
                if (formData.dataCenterRegions) total += pricing.dataCenterRegions;
                if (formData.usageAnalytics) total += pricing.usageAnalytics;
                if (formData.auditLog) total += pricing.auditLog;
                if (formData.hipaaCompliance) total += pricing.hipaaCompliance;
                
                return total;
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-50 via-white to-violet-50 p-4">
                    <div className="max-w-6xl mx-auto">
                        
                        {/* Supabase Integration Header */}
                        <div className="bg-gradient-to-r from-green-600 to-emerald-500 rounded-xl shadow-xl text-white p-4 mb-6">
                            <div className="flex items-center gap-4">
                                <div className="bg-white/20 p-3 rounded-xl">
                                    <Database className="w-8 h-8" />
                                </div>
                                <div>
                                    <h1 className="text-2xl font-bold mb-2">🎯 DIRECT SUPABASE CONNECTION!</h1>
                                    <div className="text-sm bg-white/20 rounded-lg p-3">
                                        <strong>Real cloud database!</strong> Save quotes with simple codes, load from any device worldwide!
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Main Calculator */}
                        <div className="bg-white rounded-2xl shadow-xl border border-gray-100 p-8 mb-8">
                            <div className="flex items-center gap-4 mb-6">
                                <div className="flex-1">
                                    <div className="flex items-center gap-4 mb-4">
                                        <h1 className="text-3xl font-bold bg-gradient-to-r from-purple-900 to-pink-500 bg-clip-text text-transparent">
                                            GoodData Pricing Calculator
                                        </h1>
                                        <div className="bg-gradient-to-r from-purple-900 to-pink-500 p-3 rounded-xl">
                                            <Calculator className="w-8 h-8 text-white" />
                                        </div>
                                    </div>
                                    
                                    <div className="grid md:grid-cols-2 gap-4 mb-4">
                                        <input 
                                            type="text"
                                            placeholder="Prospect/Customer Name"
                                            className="w-full p-3 text-lg border border-gray-300 rounded-lg"
                                            value={formData.prospectName}
                                            onChange={(e) => handleInputChange('prospectName', e.target.value)}
                                        />
                                        <input 
                                            type="url"
                                            placeholder="Client Website"
                                            className="w-full p-3 text-lg border border-gray-300 rounded-lg"
                                            value={formData.clientWebsite}
                                            onChange={(e) => handleInputChange('clientWebsite', e.target.value)}
                                        />
                                    </div>
                                    
                                    {/* Direct Supabase System */}
                                    <div className="bg-gradient-to-br from-green-600 to-emerald-500 rounded-xl shadow-xl text-white p-6 mb-6">
                                        <h2 className="text-xl font-semibold mb-4">🎯 Direct Supabase Connection</h2>
                                        
                                        <div className="bg-white/10 rounded-lg p-4 mb-4">
                                            <h3 className="font-semibold mb-3">Load Quote</h3>
                                            <div className="flex gap-3 items-center mb-2">
                                                <input 
                                                    type="text"
                                                    placeholder="Enter quote code (e.g., MICROSOFT-JUN12)"
                                                    value={templateCode}
                                                    onChange={(e) => setTemplateCode(e.target.value)}
                                                    className="flex-1 p-3 text-lg text-gray-900 border-0 rounded-lg"
                                                    disabled={loading}
                                                />
                                                <button
                                                    onClick={loadTemplate}
                                                    disabled={loading}
                                                    className="px-6 py-3 bg-white text-green-600 font-semibold rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50"
                                                >
                                                    {loading ? '🔄' : 'LOAD'}
                                                </button>
                                            </div>
                                            <div className="text-xs text-white/70">
                                                Local codes: {cloudStorage.getAllCodes().join(', ') || 'None saved yet'}
                                            </div>
                                        </div>

                                        <div className="bg-white/10 rounded-lg p-4">
                                            <h3 className="font-semibold mb-3">Save Quote</h3>
                                            <button
                                                onClick={saveTemplate}
                                                disabled={loading || !formData.prospectName}
                                                className="w-full bg-white text-green-600 font-semibold py-3 px-4 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50"
                                            >
                                                {loading ? '🔄 Connecting to Supabase...' : '☁️ SAVE TO SUPABASE'}
                                            </button>
                                            {!formData.prospectName && (
                                                <p className="text-white/80 text-sm mt-2">Enter prospect name to enable saving</p>
                                            )}
                                        </div>

                                        {message && (
                                            <div className="mt-4 bg-white/20 rounded-lg p-3">
                                                <p className="text-white font-medium">{message}</p>
                                            </div>
                                        )}

                                        {cloudStatus && (
                                            <div className="mt-2 bg-white/10 rounded-lg p-2">
                                                <p className="text-white/90 text-sm">{cloudStatus}</p>
                                            </div>
                                        )}
                                    </div>

                                    {/* Success Dialog */}
                                    {showSaveDialog && (
                                        <div className="bg-gradient-to-br from-blue-600 to-indigo-500 rounded-xl shadow-xl text-white p-6 mb-6">
                                            <h3 className="text-xl font-semibold mb-4">🚀 Quote Saved Successfully!</h3>
                                            <div className="bg-white/20 rounded-lg p-4 mb-4">
                                                <div className="text-center">
                                                    <div className="text-3xl font-bold mb-2">{generatedCode}</div>
                                                    <div className="text-sm text-white/90">Share this code across any device worldwide!</div>
                                                </div>
                                            </div>
                                            
                                            <p className="text-white/90 mb-4">
                                                🌍 <strong>Global access enabled!</strong> Anyone with this code can load the quote from any device with internet!
                                            </p>
                                            
                                            <div className="bg-white/20 rounded-lg p-3 mb-4">
                                                <p className="text-sm"><strong>How to share:</strong></p>
                                                <p className="text-sm">📱 Send code via email, Slack, WhatsApp, SMS</p>
                                                <p className="text-sm">🌐 Works on any device: phones, tablets, computers</p>
                                                <p className="text-sm">⚡ Instant loading from Supabase cloud database</p>
                                            </div>
                                            
                                            <div className="grid grid-cols-2 gap-2">
                                                <button 
                                                    onClick={() => {
                                                        navigator.clipboard.writeText(generatedCode);
                                                        setMessage(`📋 Code "${generatedCode}" copied!`);
                                                        setTimeout(() => setMessage(''), 2000);
                                                    }} 
                                                    className="bg-white text-blue-600 font-semibold py-2 px-3 rounded-lg hover:bg-gray-50 text-sm"
                                                >
                                                    📋 Copy Code
                                                </button>
                                                <button 
                                                    onClick={() => setShowSaveDialog(false)} 
                                                    className="bg-white/20 text-white font-semibold py-2 px-3 rounded-lg hover:bg-white/30 text-sm"
                                                >
                                                    ✓ Done
                                                </button>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                            
                            {/* Tabs */}
                            <div className="flex bg-gray-100 rounded-lg p-1">
                                <button
                                    onClick={() => setActiveTab('qualification')}
                                    className={`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-md transition-all ${
                                        activeTab === 'qualification' ? 'bg-white text-purple-900 shadow-sm' : 'text-gray-600'
                                    }`}
                                >
                                    <Users className="w-4 h-4" />
                                    Customer Qualification
                                </button>
                                <button
                                    onClick={() => setActiveTab('pricing')}
                                    className={`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-md transition-all ${
                                        activeTab === 'pricing' ? 'bg-white text-purple-900 shadow-sm' : 'text-gray-600'
                                    }`}
                                >
                                    <FileText className="w-4 h-4" />
                                    Pricing Breakdown
                                </button>
                            </div>
                        </div>

                        {/* Tab Content */}
                        {activeTab === 'qualification' && (
                            <div className="grid lg:grid-cols-3 gap-8">
                                <div className="lg:col-span-2 space-y-6">
                                    
                                    {/* Customer Profile */}
                                    <div className="bg-white rounded-xl shadow-lg border border-gray-100 p-6">
                                        <div className="flex items-center gap-3 mb-6">
                                            <Building className="w-6 h-6 text-purple-900" />
                                            <h2 className="text-xl font-semibold text-gray-800">Customer Profile</h2>
                                        </div>
                                        
                                        <div className="space-y-6">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Package</label>
                                                <select 
                                                    className="w-full p-3 border border-gray-300 rounded-lg"
                                                    value={formData.package}
                                                    onChange={(e) => handleInputChange('package', e.target.value)}
                                                >
                                                    <option value="">Select Package</option>
                                                    {formData.llmProvider === 'Customer' && (
                                                        <>
                                                            <option value="Small">Small - $100/month</option>
                                                            <option value="Medium">Medium - $430/month</option>
                                                            <option value="Large">Large - $750/month</option>
                                                        </>
                                                    )}
                                                    {formData.llmProvider === 'GoodData' && (
                                                        <>
                                                            <option value="Small">Small - $200/month</option>
                                                            <option value="Medium">Medium - $860/month</option>
                                                            <option value="Large">Large - $1,500/month</option>
                                                        </>
                                                    )}
                                                    {!formData.llmProvider && (
                                                        <>
                                                            <option value="Small">Small</option>
                                                            <option value="Medium">Medium</option>
                                                            <option value="Large">Large</option>
                                                        </>
                                                    )}
                                                </select>
                                            </div>
                                            
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Professional Services</label>
                                                <select 
                                                    className="w-full p-3 border border-gray-300 rounded-lg"
                                                    value={formData.professionalServices}
                                                    onChange={(e) => handleInputChange('professionalServices', e.target.value)}
                                                >
                                                    <option value="">Select Service</option>
                                                    <option value="Advisory">Advisory 80 hours - $10,000</option>
                                                    <option value="Analytics">Analytics 300 hours - $37,500</option>
                                                    <option value="End-to-end">End-to-end 800 hours - $100,000</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Add-ons */}
                                    <div className="bg-white rounded-xl shadow-lg border border-gray-100 p-6">
                                        <h2 className="text-xl font-semibold text-gray-800 mb-6">Premium Add-ons</h2>
                                        
                                        <div className="space-y-4">
                                            {[
                                                { key: 'additionalEnvironments', label: 'Additional Environments' },
                                                { key: 'samlOidc', label: 'SAML & Multiple OIDC' },
                                                { key: 'dataCenterRegions', label: 'Data Center Regions' },
                                                { key: 'usageAnalytics', label: 'Usage Analytics' },
                                                { key: 'auditLog', label: 'Audit Log' },
                                                { key: 'hipaaCompliance', label: 'HIPAA Compliance' }
                                            ].map(addon => (
                                                <label key={addon.key} className="flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                                                    <input 
                                                        type="checkbox"
                                                        checked={formData[addon.key]}
                                                        onChange={(e) => handleInputChange(addon.key, e.target.checked)}
                                                        className="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"
                                                    />
                                                    <span className="text-gray-700 font-medium">{addon.label}</span>
                                                </label>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Comments */}
                                    <div className="bg-white rounded-xl shadow-lg border border-gray-100 p-6">
                                        <h2 className="text-xl font-semibold text-gray-800 mb-6">Comments</h2>
                                        <div className="grid md:grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">AE Comments</label>
                                                <textarea 
                                                    className="w-full p-3 border border-gray-300 rounded-lg"
                                                    rows="3"
                                                    value={formData.aeComments}
                                                    onChange={(e) => handleInputChange('aeComments', e.target.value)}
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Finance Comments</label>
                                                <textarea 
                                                    className="w-full p-3 border border-gray-300 rounded-lg"
                                                    rows="3"
                                                    value={formData.financeComments}
                                                    onChange={(e) => handleInputChange('financeComments', e.target.value)}
                                                />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Right Column - Quick Summary */}
                                <div>
                                    <div className="bg-gradient-to-br from-purple-900 to-pink-500 rounded-xl shadow-xl text-white p-6 sticky top-4">
                                        <h2 className="text-xl font-semibold mb-6">Quick Estimate</h2>
                                        
                                        <div className="space-y-4">
                                            <div className="bg-white/10 rounded-lg p-4">
                                                <div className="text-sm opacity-90 mb-1">Total Annual</div>
                                                <div className="text-3xl font-bold">
                                                    ${calculateTotal().toLocaleString()}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <button
                                            onClick={() => setActiveTab('pricing')}
                                            className="w-full mt-6 bg-white text-purple-900 font-semibold py-3 px-4 rounded-lg"
                                        >
                                            View Detailed Quote →
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Pricing Tab */}
                        {activeTab === 'pricing' && (
                            <div className="bg-white rounded-xl shadow-xl border border-gray-100 p-8">
                                <div className="flex items-center justify-between mb-8">
                                    <div>
                                        <h2 className="text-2xl font-bold text-gray-800">Pricing Breakdown</h2>
                                        <p className="text-gray-600 mt-1">Annual subscription pricing</p>
                                    </div>
                                    <div className="text-right">
                                        <div className="text-sm text-gray-600">Total Annual Contract</div>
                                        <div className="text-3xl font-bold text-purple-900">
                                            ${calculateTotal().toLocaleString()}
                                        </div>
                                    </div>
                                </div>

                                <div className="space-y-6">
                                    <div className="border border-gray-200 rounded-lg p-6">
                                        <h3 className="text-lg font-semibold text-gray-800 mb-4">Platform Components</h3>
                                        
                                        <div className="space-y-3">
                                            <div className="flex justify-between items-center py-2 border-b">
                                                <span>Platform Fee</span>
                                                <div className="flex items-center gap-2">
                                                    <span>$</span>
                                                    <input 
                                                        type="number" 
                                                        value={pricing.platformFee}
                                                        onChange={(e) => setPricing(prev => ({...prev, platformFee: parseInt(e.target.value) || 0}))}
                                                        className="w-24 p-1 text-right border rounded"
                                                    />
                                                </div>
                                            </div>
                                            
                                            {formData.biWorkspaces && (
                                                <div className="flex justify-between items-center py-2 border-b">
                                                    <span>BI Workspaces ({formData.biWorkspaces} × $</span>
                                                    <div className="flex items-center gap-2">
                                                        <input 
                                                            type="number" 
                                                            value={pricing.biWorkspacePrice}
                                                            onChange={(e) => setPricing(prev => ({...prev, biWorkspacePrice: parseInt(e.target.value) || 0}))}
                                                            className="w-16 p-1 text-right border rounded"
                                                        />
                                                        <span>× 12) = ${((parseInt(formData.biWorkspaces) || 0) * pricing.biWorkspacePrice * 12).toLocaleString()}</span>
                                                    </div>
                                                </div>
                                            )}
                                            
                                            {formData.aiWorkspaces && (
                                                <div className="flex justify-between items-center py-2 border-b">
                                                    <span>AI Workspaces ({formData.aiWorkspaces} × $</span>
                                                    <div className="flex items-center gap-2">
                                                        <input 
                                                            type="number" 
                                                            value={pricing.aiWorkspacePrice}
                                                            onChange={(e) => setPricing(prev => ({...prev, aiWorkspacePrice: parseInt(e.target.value) || 0}))}
                                                            className="w-16 p-1 text-right border rounded"
                                                        />
                                                        <span>× 12) = ${((parseInt(formData.aiWorkspaces) || 0) * pricing.aiWorkspacePrice * 12).toLocaleString()}</span>
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    </div>

                                    <div className="bg-gradient-to-r from-purple-900 to-pink-500 text-white rounded-lg p-6">
                                        <div className="flex justify-between items-center text-xl font-bold">
                                            <div>Total Annual Contract Value</div>
                                            <div>${calculateTotal().toLocaleString()}</div>
                                        </div>
                                        <div className="flex justify-between items-center mt-2 opacity-90">
                                            <div>Monthly equivalent</div>
                                            <div>${(calculateTotal()/12).toLocaleString()}</div>
                                        </div>
                                    </div>

                                    <div className="bg-gradient-to-r from-green-600 to-emerald-500 text-white rounded-lg p-6">
                                        <h3 className="text-xl font-bold mb-3">🎯 Direct Supabase Integration!</h3>
                                        <div className="space-y-2 text-green-100">
                                            <p>✅ <strong>Real cloud database:</strong> True cross-device quote sharing</p>
                                            <p>✅ <strong>Simple codes:</strong> Use "MICROSOFT-JUN12" anywhere</p>
                                            <p>✅ <strong>Global access:</strong> Works on any device with internet</p>
                                            <p>✅ <strong>Professional reliability:</strong> Local backup + cloud sync</p>
                                        </div>
                                        <div className="mt-4 bg-white/20 rounded-lg p-3">
                                            <p className="font-semibold">Enterprise-grade solution!</p>
                                            <p className="text-sm text-green-100">Create → Share code → Load anywhere → Close deals faster</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<GoodDataCalculator />, document.getElementById('root'));
    </script>
</body>
</html>">Annual Revenue (USD)</label>
                                                <select 
                                                    className="w-full p-4 text-lg border border-gray-300 rounded-lg bg-gray-50"
                                                    value={formData.annualRevenue}
                                                    onChange={(e) => handleInputChange('annualRevenue', e.target.value)}
                                                >
                                                    <option value="">Select Range</option>
                                                    <option value="< 10M">&lt; $10M</option>
                                                    <option value="10M - 50M">$10M - $50M</option>
                                                    <option value="50M - 100M">$50M - $100M</option>
                                                    <option value="100M+">$100M+</option>
                                                </select>
                                            </div>
                                            
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Budget</label>
                                                <input 
                                                    className="w-full p-4 text-lg border border-gray-300 rounded-lg bg-gray-50"
                                                    placeholder="e.g. $50K-100K annually"
                                                    value={formData.budget}
                                                    onChange={(e) => handleInputChange('budget', e.target.value)}
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">What are they looking to achieve with GoodData?</label>
                                                <textarea 
                                                    className="w-full p-4 text-lg border border-gray-300 rounded-lg bg-gray-50 resize-none"
                                                    rows="4"
                                                    placeholder="Describe their goals and objectives..."
                                                    value={formData.objectives}
                                                    onChange={(e) => handleInputChange('objectives', e.target.value)}
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    {/* Workspace Configuration */}
                                    <div className="bg-white rounded-xl shadow-lg border border-gray-100 p-6">
                                        <div className="flex items-center gap-3 mb-6">
                                            <Database className="w-6 h-6 text-pink-500" />
                                            <h2 className="text-xl font-semibold text-gray-800">Workspace Configuration</h2>
                                        </div>
                                        
                                        <div className="grid md:grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Total Workspaces</label>
                                                <input 
                                                    type="number"
                                                    className="w-full p-3 border border-gray-300 rounded-lg"
                                                    value={formData.totalWorkspaces}
                                                    onChange={(e) => handleInputChange('totalWorkspaces', e.target.value)}
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">BI Workspaces</label>
                                                <input 
                                                    type="number"
                                                    className="w-full p-3 border border-gray-300 rounded-lg"
                                                    value={formData.biWorkspaces}
                                                    onChange={(e) => handleInputChange('biWorkspaces', e.target.value)}
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">AI Workspaces</label>
                                                <input 
                                                    type="number"
                                                    className="w-full p-3 border border-gray-300 rounded-lg"
                                                    value={formData.aiWorkspaces}
                                                    onChange={(e) => handleInputChange('aiWorkspaces', e.target.value)}
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">LLM Provider</label>
                                                <select 
                                                    className="w-full p-3 border border-gray-300 rounded-lg"
                                                    value={formData.llmProvider}
                                                    onChange={(e) => handleInputChange('llmProvider', e.target.value)}
                                                >
                                                    <option value="">Select Provider</option>
                                                    <option value="Customer">Customer</option>
                                                    <option value="GoodData">GoodData</option>
                                                </select>
                                            </div>
                                            
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2
